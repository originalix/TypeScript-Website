{"version":3,"sources":["webpack://typescriptlang-org/./src/components/SuppressWhenTouch.tsx","webpack://typescriptlang-org/./src/components/devNav.tsx","webpack://typescriptlang-org/./src/lib/isTouchDevice.ts","webpack://typescriptlang-org/../shiki-twoslash/src/utils.ts","webpack://typescriptlang-org/../shiki-twoslash/src/renderers/twoslash.ts","webpack://typescriptlang-org/../shiki-twoslash/src/parseCodeFenceInfo.ts","webpack://typescriptlang-org/./src/pages/dev/twoslash.tsx"],"names":["SuppressWhenTouch","children","hideOnTouch","useEffect","isTouchDevice","suppressible","document","getElementById","firstChild","removeChild","h4","createElement","textContent","p","appendChild","id","DevNav","props","isActive","str","active","toLowerCase","className","style","display","href","withPrefix","hasTouchScreen","navigator","maxTouchPoints","msMaxTouchPoints","mQ","window","matchMedia","media","matches","UA","userAgent","test","createHighlightedString2","ranges","text","targetedWord","actions","hasErrors","forEach","r","classes","underLineTargetedWord","lsp","push","index","end","begin","html","slice","sort","l","action","idx","rem","newString","Math","abs","replaceTripleArrow","stripHTML","replace","table","toString","chr","escapeHtml","twoslashRenderer","lines","options","twoslash","codefenceMeta","meta","hasHighlight","Object","keys","find","key","includes","NaN","parseInt","hl","split","first","last","lastIndex","i","line","shouldHighlightLine","bg","fg","class","langId","errorsGroupedByLine","groupBy","errors","e","Map","staticQuickInfosGroupedByLine","staticQuickInfos","q","queriesGroupedByLine","queries","filePos","get","lspValues","length","hiClass","tokenPos","token","targetedQueryWord","tokenContent","findTokenFunc","start","character","content","errorsInToken","filter","lspResponsesInToken","queriesInToken","response","allTokensByStart","map","range","kind","color","messages","renderedMessage","join","codes","code","query","queryTextWithPrefix","halfWayAcrossTheTargetedWord","repeat","completions","lis","c","name","startsWith","completionsPrefix","localeCompare","after","substr","kindModifiers","padStart","offset","playgroundLink","playgroundURL","list","keyGetter","item","collection","set","Index","getLoaderScript","src","async","onload","re","global","require","config","paths","vs","sandbox","ignoreDuplicateModules","main","ts","sandboxEnv","_ts","parentNode","console","error","createTypeScriptSandbox","codeSamples","compilerOptions","domID","supportTwoslashCompilerOptions","editor","focus","createDefaultMapFromCDN","target","lzstring","mapWithLibFiles","runTwoslash","newContent","getText","newResults","twoslasher","tsModule","lzstringModule","fsMap","results","innerHTML","innerText","extension","a","err","failure","header","opener","message","log","debouncedTwoslash","debounce","onDidChangeModelContent","setTimeout","querySelectorAll","button","classList","remove","codeElement","monaco","colorize","tabSize","then","newHTML","body","title","description","lang","marginTop","paddingTop","maxWidth","flex","blurb","role","height","onClick","contains","setText","paddingLeft","borderLeft","position","overflow","Intl","locale"],"mappings":"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","file":"component---src-pages-dev-twoslash-tsx-96756a653e8d2df72b86.js","sourcesContent":["import React, { useEffect } from \"react\"\nimport { isTouchDevice } from \"../lib/isTouchDevice\"\n\n/**\n * A React component which will remove its children (at runtime!)\n * from the hierarchy if we're on a touch device\n */\nexport const SuppressWhenTouch = ({ children, hideOnTouch }: any) => {\n\n  useEffect(() => {\n    if (isTouchDevice()) {\n      // It's touch, so let's kill the content in the child and \n      // replace it with a message that this section isn't good for mobile\n      const suppressible = document.getElementById(\"touch-suppressible\")!\n      while (suppressible.firstChild) {\n        suppressible.removeChild(suppressible.firstChild)\n      }\n\n      if (hideOnTouch) return\n\n      const h4 = document.createElement(\"h4\")\n      h4.textContent = \"Section best on a computer\"\n\n      const p = document.createElement(\"p\")\n      p.textContent = \"This part of the site does not run well on a touch-oriented browser. We recommend switching to a computer to carry on.\"\n\n      suppressible.appendChild(h4)\n      suppressible.appendChild(p)\n    }\n\n  }, [])\n  return (\n    <div id=\"touch-suppressible\">\n      {children}\n    </div>)\n}\n","import * as React from \"react\"\nimport { withPrefix } from \"gatsby\"\n\ninterface DevNavProps {\n  active?: string\n}\n\nexport const DevNav = (props: DevNavProps) => {\n  const isActive = (str) =>\n    props.active && props.active.toLowerCase() === str ? \"active\" : \"\"\n\n  return <nav className=\"navbar-sub dev-tools\">\n    <ul className=\"nav\">\n      <li className=\"name\"><h3>Developer Tools</h3></li>\n      <li style={{ display: \"none\" }}>\n        <a className={isActive(\"compiler api\")} href={withPrefix(\"/dev/compiler\")}>Compiler API</a>\n      </li>\n      <li>\n        <a className={isActive(\"sandbox\")} href={withPrefix(\"/dev/sandbox\")}>Sandbox</a>\n      </li>\n      <li>\n        <a className={isActive(\"twoslash\")} href={withPrefix(\"/dev/twoslash\")}>Twoslash</a>\n      </li>\n      <li>\n        <a className={isActive(\"typescript vfs\")} href={withPrefix(\"/dev/typescript-vfs\")}>TypeScript VFS</a>\n      </li>\n      <li>\n        <a className={isActive(\"playground plugins\")} href={withPrefix(\"/dev/playground-plugins\")}>Playground Plugins</a>\n      </li>\n      <li>\n        <a className={isActive(\"bug workbench\")} href={withPrefix(\"/dev/bug-workbench\")}>Bug Workbench</a>\n      </li>\n    </ul>\n  </nav >\n}\n","/** Based on https://developer.mozilla.org/docs/Web/HTTP/Browser_detection_using_the_user_agent */\nexport function isTouchDevice() {\n  var hasTouchScreen = false\n  if (\"maxTouchPoints\" in navigator) {\n    hasTouchScreen = navigator.maxTouchPoints > 0\n  } else if (\"msMaxTouchPoints\" in navigator) {\n    // @ts-ignore\n    hasTouchScreen = navigator.msMaxTouchPoints > 0\n  } else {\n    var mQ =\n      typeof window !== \"undefined\" &&\n      window.matchMedia &&\n      matchMedia(\"(pointer:coarse)\")\n    if (mQ && mQ.media === \"(pointer:coarse)\") {\n      hasTouchScreen = !!mQ.matches\n    } else if (\"orientation\" in window) {\n      hasTouchScreen = true // deprecated, but good fallback\n    } else {\n      // Only as a last resort, fall back to user agent sniffing\n      // @ts-ignore\n      var UA = navigator.userAgent\n      hasTouchScreen =\n        /\\b(BlackBerry|webOS|iPhone|IEMobile)\\b/i.test(UA) ||\n        /\\b(Android|Windows Phone|iPad|iPod)\\b/i.test(UA)\n    }\n  }\n  return hasTouchScreen\n}\n","type Range = {\n  begin: number\n  end: number\n  text?: string\n  count?: number\n  tooltip?: string[]\n  classes?: string\n  lsp?: string\n}\n\nconst splice = (str: string, idx: number, rem: number, newString: string) =>\n  str.slice(0, idx) + newString + str.slice(idx + Math.abs(rem))\n\n/**\n * We're given the text which lives inside the token, and this function will\n * annotate it with twoslash metadata\n */\nexport function createHighlightedString2(ranges: Range[], text: string, targetedWord: string = \"\") {\n  const actions = [] as { text: string; index: number }[]\n  let hasErrors = false\n\n  // Why the weird chars? We need to make sure that generic syntax isn't\n  // interpreted as html tags - to do that we need to switch out < to &lt; - *but*\n  // making that transition changes the indexes because it's gone from 1 char to 4 chars\n\n  // So, use an obscure character to indicate a real < for HTML, then switch it after\n\n  ranges.forEach(r => {\n    if (r.classes === \"lsp\") {\n      const underLineTargetedWord = r.lsp === targetedWord ? \"style=⇯border-bottom: solid 2px lightgrey;⇯\" : \"\"\n      actions.push({ text: \"⇍/data-lsp⇏\", index: r.end })\n      actions.push({ text: `⇍data-lsp lsp=⇯${r.lsp || \"\"}⇯ ${underLineTargetedWord}⇏`, index: r.begin })\n    } else if (r.classes === \"err\") {\n      hasErrors = true\n    } else if (r.classes === \"query\") {\n      actions.push({ text: \"⇍/data-highlight⇏\", index: r.end })\n      actions.push({ text: `⇍data-highlight'⇏`, index: r.begin })\n    }\n  })\n\n  let html = (\" \" + text).slice(1)\n\n  // Apply all the edits\n  actions\n    .sort((l, r) => r.index - l.index)\n    .forEach(action => {\n      html = splice(html, action.index, 0, action.text)\n    })\n\n  if (hasErrors) html = `⇍data-err⇏${html}⇍/data-err⇏`\n\n  return replaceTripleArrow(stripHTML(html))\n}\n\nexport const subTripleArrow = (str: string) => str.replace(/</g, \"⇍\").replace(/>/g, \"⇏\").replace(/'/g, \"⇯\")\nexport const replaceTripleArrow = (str: string) => str.replace(/⇍/g, \"<\").replace(/⇏/g, \">\").replace(/⇯/g, \"'\")\nexport const replaceTripleArrowEncoded = (str: string) =>\n  str.replace(/⇍/g, \"&lt;\").replace(/⇏/g, \"&gt;\").replace(/⇯/g, \"&apos;\")\n\nexport function stripHTML(text: string) {\n  var table: any = {\n    \"<\": \"lt\",\n    '\"': \"quot\",\n    \"'\": \"apos\",\n    \"&\": \"amp\",\n    \"\\r\": \"#10\",\n    \"\\n\": \"#13\",\n  }\n\n  return text.toString().replace(/[<\"'\\r\\n&]/g, function (chr) {\n    return \"&\" + table[chr] + \";\"\n  })\n}\n\nexport function escapeHtml(html: string) {\n  return html.replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")\n}\n","type Lines = import(\"shiki\").IThemedToken[][]\ntype TwoSlash = import(\"@typescript/twoslash\").TwoSlashReturn\n\nimport { shouldBeHighlightable, shouldHighlightLine } from \"../parseCodeFenceInfo\"\nimport { stripHTML, createHighlightedString2, subTripleArrow, replaceTripleArrowEncoded, escapeHtml } from \"../utils\"\nimport { HtmlRendererOptions } from \"./plain\"\n\n// OK, so - this is just straight up complex code.\n\n// What we're trying to do is merge two sets of information into a single tree for HTML\n\n// 1: Syntax highlight info from shiki\n// 2: Twoslash metadata like errors, identifiers etc\n\n// Because shiki gives use a set of lines to work from, then the first thing which happens\n// is converting twoslash data into the same format.\n\n// Things which make it hard:\n//\n// - Twoslash results can be cut, so sometimes there is edge cases between twoslash results\n// - Twoslash results can be multi-file\n// - the DOM requires a flattened graph of html elements\n//\n\nexport function twoslashRenderer(lines: Lines, options: HtmlRendererOptions, twoslash: TwoSlash, codefenceMeta: any) {\n  let html = \"\"\n\n  const hasHighlight = shouldBeHighlightable(codefenceMeta)\n  const hl = shouldHighlightLine(codefenceMeta)\n  const bg = options.bg || \"#fff\"\n  const fg = options.fg || \"black\"\n  const classes = codefenceMeta.class || \"\"\n\n  html += `<pre class=\"shiki twoslash lsp ${classes}\" style=\"background-color: ${bg}; color: ${fg}\">`\n  if (options.langId) {\n    html += `<div class=\"language-id\">${options.langId}</div>`\n  }\n  html += `<div class='code-container'><code>`\n\n  const errorsGroupedByLine = groupBy(twoslash.errors, e => e.line) || new Map()\n  const staticQuickInfosGroupedByLine = groupBy(twoslash.staticQuickInfos, q => q.line) || new Map()\n  // A query is always about the line above it!\n  const queriesGroupedByLine = groupBy(twoslash.queries, q => q.line - 1) || new Map()\n\n  /**\n   * This is the index of the original twoslash code reference, it is not\n   * related to the HTML output\n   */\n  let filePos = 0\n\n  lines.forEach((l, i) => {\n    const errors = errorsGroupedByLine.get(i) || []\n    const lspValues = staticQuickInfosGroupedByLine.get(i) || []\n    const queries = queriesGroupedByLine.get(i) || []\n\n    if (l.length === 0 && i === 0) {\n      // Skip the first newline if it's blank\n      filePos += 1\n    } else if (l.length === 0) {\n      filePos += 1\n      html += `\\n`\n    } else {\n      const hiClass = hasHighlight ? (hl(i) ? \" highlight\" : \" dim\") : \"\"\n      const prefix = `<div class='line${hiClass}'>`\n      html += prefix\n\n      // Keep track of the position of the current token in a line so we can match it up to the\n      // errors and lang serv identifiers\n      let tokenPos = 0\n\n      l.forEach(token => {\n        let targetedQueryWord: typeof twoslash.staticQuickInfos[number] | undefined\n\n        let tokenContent = \"\"\n        // Underlining particular words\n        const findTokenFunc = (start: number) => (e: any) =>\n          start <= e.character && start + token.content.length >= e.character + e.length\n\n        const findTokenDebug = (start: number) => (e: any) => {\n          const result = start <= e.character && start + token.content.length >= e.character + e.length\n          // prettier-ignore\n          console.log(result, start, '<=', e.character, '&&', start + token.content.length, '>=', e.character + e.length)\n          if (result) {\n            console.log(\"Found:\", e)\n            console.log(\"Inside:\", token)\n          }\n          return result\n        }\n\n        const errorsInToken = errors.filter(findTokenFunc(tokenPos))\n        const lspResponsesInToken = lspValues.filter(findTokenFunc(tokenPos))\n        const queriesInToken = queries.filter(findTokenFunc(tokenPos))\n\n        // Does this line have a word targeted by a query?\n        targetedQueryWord ||= lspResponsesInToken.find(response => response.text === (queries.length && queries[0].text))!\n\n        const allTokens = [...errorsInToken, ...lspResponsesInToken, ...queriesInToken]\n        const allTokensByStart = allTokens.sort((l, r) => {\n          return (l.start || 0) - (r.start || 0)\n        })\n\n        if (allTokensByStart.length) {\n          const ranges = allTokensByStart.map(token => {\n            const range: any = {\n              begin: token.start! - filePos,\n              end: token.start! + token.length! - filePos,\n            }\n\n            // prettier-ignore\n            if (range.begin < 0 || range.end < 0) {\n              // prettier-ignore\n              // throw new Error(`The begin range of a token is at a minus location, filePos:${filePos} current token: ${JSON.stringify(token, null, '  ')}\\n result: ${JSON.stringify(range, null, '  ')}`)\n            }\n\n            if (\"renderedMessage\" in token) range.classes = \"err\"\n            if (\"kind\" in token) range.classes = token.kind\n            if (\"targetString\" in token) {\n              range.classes = \"lsp\"\n              range[\"lsp\"] = stripHTML(token.text)\n            }\n            return range\n          })\n\n          tokenContent += createHighlightedString2(ranges, token.content, targetedQueryWord?.text)\n        } else {\n          tokenContent += subTripleArrow(token.content)\n        }\n\n        html += `<span style=\"color: ${token.color}\">${tokenContent}</span>`\n        tokenPos += token.content.length\n        filePos += token.content.length\n      })\n\n      html += `</div>`\n      // This is the \\n which the </div> represents\n      filePos += 1\n    }\n\n    // Adding error messages to the line after\n    if (errors.length) {\n      const messages = errors.map(e => escapeHtml(e.renderedMessage)).join(\"</br>\")\n      const codes = errors.map(e => e.code).join(\"<br/>\")\n      html += `<span class=\"error\"><span>${messages}</span><span class=\"code\">${codes}</span></span>`\n      html += `<span class=\"error-behind\">${messages}</span>`\n    }\n\n    // Add queries to the next line\n    if (queries.length) {\n      queries.forEach(query => {\n        switch (query.kind) {\n          case \"query\": {\n            const queryTextWithPrefix = escapeHtml(query.text!)\n            const lspValues = staticQuickInfosGroupedByLine.get(i) || []\n            const targetedWord = lspValues.find(response => response.text === (queries.length && queries[0].text))!\n            const halfWayAcrossTheTargetedWord = ((targetedWord && targetedWord.character + targetedWord?.length / 2) - 1) || 0\n            html +=\n              `<span class='popover-prefix'>` +\n              \" \".repeat(halfWayAcrossTheTargetedWord) +\n              \"</span>\" +\n              `<span class='popover'><div class='arrow'></div>${queryTextWithPrefix}</span>`\n            break\n          }\n\n          case \"completions\": {\n            if (!query.completions) {\n              html += `<span class='query'>${\"//\" + \"\".padStart(query.offset - 2) + \"^ - No completions found\"}</span>`\n            } else {\n              const prefixed = query.completions.filter(c => c.name.startsWith(query.completionsPrefix || \"____\"))\n\n              const lis = prefixed\n                .sort((l, r) => l.name.localeCompare(r.name))\n                .map(c => {\n                  const after = c.name.substr(query.completionsPrefix?.length || 0)\n                  const name = `<span><span class='result-found'>${query.completionsPrefix || \"\"}</span>${after}<span>`\n                  const isDeprecated = c.kindModifiers?.split(\",\").includes(\"deprecated\")\n                  const liClass = isDeprecated ? \"deprecated\" : \"\"\n                  return `<li class='${liClass}'>${name}</li>`\n                })\n                .join(\"\")\n              html +=\n                \"\".padStart(query.offset) + `<span class='inline-completions'><ul class='dropdown'>${lis}</ul></span>`\n            }\n          }\n        }\n      })\n      html += \"\\n\"\n    }\n  })\n  html = replaceTripleArrowEncoded(html.replace(/\\n*$/, \"\")) // Get rid of final new lines\n  const playgroundLink = `<a href='${twoslash.playgroundURL}'>Try</a>`\n  html += `</code>${playgroundLink}</div></pre>`\n\n  return html\n}\n\n/** Returns a map where all the keys are the value in keyGetter  */\nfunction groupBy<T>(list: T[], keyGetter: (obj: any) => number) {\n  const map = new Map<number, T[]>()\n  list.forEach(item => {\n    const key = keyGetter(item)\n    const collection = map.get(key)\n    if (!collection) {\n      map.set(key, [item])\n    } else {\n      collection.push(item)\n    }\n  })\n  return map\n}\n","// Based on https://github.com/andrewbranch/gatsby-remark-vscode/blob/7bf5c036a58652c1f45d27c5874557f7b531102c/src/index.js\n// which is MIT https://github.com/andrewbranch/gatsby-remark-vscode/blob/7bf5c036a58652c1f45d27c5874557f7b531102c/LICENSE\n// Only difference is conversion to TypeScript, and a replace at the top\n\nconst identifierPattern = /[a-z0-9-–—_+#]/i\nconst triviaPattern = /\\s/\nconst startOfNumberPattern = /[0-9-.]/\nconst numberPattern = /[0-9-.e]/\n\nfunction testRegex(input: string, pattern: RegExp) {\n  if (input === undefined) return false\n  return pattern.test(input)\n}\n\n/** Takes the language and a meta-string and offers a useful object for looking at params */\nexport function parseCodeFenceInfo(lang: string, fullMetaString: string) {\n  // Heh\n  const metaString = fullMetaString.replace(\"twoslash\", \"\")\n  let pos = 0\n  let meta = {}\n  let languageName = \"\"\n  const input = [lang, metaString].filter(Boolean).join(\" \")\n  skipTrivia()\n  if (!isEnd() && current() !== \"{\") {\n    languageName = parseIdentifier()\n  }\n  const languageNameEnd = pos\n  skipTrivia()\n  if (!isEnd() && current() === \"{\") {\n    meta = parseObject()\n  }\n\n  if (!isEnd() && languageNameEnd === pos) {\n    return fail(`Invalid character in language name: '${current()}'`)\n  }\n\n  return { languageName, meta }\n\n  function current(): string {\n    if (isEnd()) {\n      return fail(\"Unexpected end of input\")\n    }\n    return input[pos]\n  }\n\n  function isEnd() {\n    return pos >= input.length\n  }\n\n  function fail(message: string): never {\n    throw new Error(`Failed parsing code fence header '${input}' at position ${pos}: ${message}`)\n  }\n\n  function scanExpected(expected: string): void {\n    if (isEnd() || current() !== expected) {\n      return fail(`Expected '${expected}'`)\n    }\n    pos++\n  }\n\n  function parseIdentifier(errorMessage = \"Expected identifier, but got nothing\") {\n    let identifier = \"\"\n    while (!isEnd() && testRegex(current(), identifierPattern)) {\n      identifier += current()\n      pos++\n    }\n    if (!identifier) {\n      return fail(errorMessage)\n    }\n    return identifier\n  }\n\n  function skipTrivia() {\n    while (!isEnd() && testRegex(current(), triviaPattern)) pos++\n  }\n\n  function parseChar() {\n    let char = current()\n    if (char === \"\\\\\") {\n      pos++\n      char += current()\n    }\n    pos++\n    return char\n  }\n\n  function parseString() {\n    let str = \"\"\n    const quote = current()\n    pos++\n    while (true) {\n      const char = parseChar()\n      if (char === quote) break\n      str += char.replace(/\\\\/, \"\")\n    }\n    return str\n  }\n\n  function parseNumber() {\n    let numStr = current()\n    pos++\n    while (!isEnd() && testRegex(current(), numberPattern)) {\n      numStr += current()\n      pos++\n    }\n    return parseFloat(numStr)\n  }\n\n  function parseBoolean() {\n    const identifier = parseIdentifier(\"Expected expression, but got nothing\")\n    switch (identifier) {\n      case \"true\":\n        return true\n      case \"false\":\n        return false\n      case \"\":\n        return fail(\"Expected expression, but got nothing\")\n      default:\n        return fail(`Unrecognized input '${identifier}'`)\n    }\n  }\n\n  function parseExpression() {\n    switch (current()) {\n      case \"{\":\n        return parseObject()\n      case `'`:\n      case '\"':\n        return parseString()\n    }\n    if (testRegex(current(), startOfNumberPattern)) {\n      return parseNumber()\n    }\n    return parseBoolean()\n  }\n\n  function parseObject() {\n    let obj: any = {}\n    scanExpected(\"{\")\n    skipTrivia()\n    while (!isEnd() && current() !== \"}\") {\n      const key = parseIdentifier()\n\n      let value: any = true\n      skipTrivia()\n      if (current() === \":\") {\n        pos++\n        skipTrivia()\n        value = parseExpression()\n        skipTrivia()\n      }\n      obj[key] = value\n      if (current() === \",\") pos++\n      skipTrivia()\n    }\n    scanExpected(\"}\")\n    return obj\n  }\n}\n\n/** Does anything in the object imply that we should highlight any lines? */\nexport const shouldBeHighlightable = (meta: any) => {\n  return !!Object.keys(meta).find(key => {\n    if (key.includes(\"-\")) return true\n    if (parseInt(key) !== NaN) return true\n    return false\n  })\n}\n\n/** Returns a func for figuring out if this line should be highlighted */\nexport const shouldHighlightLine = (meta: any) => {\n  const lines: number[] = []\n  Object.keys(meta).find(key => {\n    if (parseInt(key) !== NaN) lines.push(parseInt(key))\n    if (key.includes(\"-\")) {\n      const [first, last] = key.split(\"-\")\n      const lastIndex = parseInt(last) + 1\n      for (let i = parseInt(first); i < lastIndex; i++) {\n        lines.push(i)\n      }\n    }\n  })\n\n  return (line: number) => lines.includes(line)\n}\n","import React, { useEffect } from \"react\"\nimport { Layout } from \"../../components/layout\"\nimport { withPrefix, graphql } from \"gatsby\"\nimport { twoslasher } from \"@typescript/twoslash\"\nimport { createDefaultMapFromCDN } from \"@typescript/vfs\"\nimport { twoslashRenderer } from \"shiki-twoslash/src/renderers/twoslash\"\nimport { debounce } from \"ts-debounce\"\n\nimport \"./dev.scss\"\nimport { Intl } from \"../../components/Intl\"\nimport { DevNav } from \"../../components/devNav\"\nimport { isTouchDevice } from \"../../lib/isTouchDevice\"\nimport { SuppressWhenTouch } from \"../../components/SuppressWhenTouch\"\n\n/** Note: to run all the web infra in debug, run:\n  localStorage.debug = '*'\n\n  to remove logging: localStorage.debug = undefined\n */\n\ntype Props = {}\n\nconst Index: React.FC<Props> = props => {\n  useEffect(() => {\n    // No monaco for touch\n    if (isTouchDevice()) {\n      return\n    }\n\n    const getLoaderScript = document.createElement(\"script\")\n    getLoaderScript.src = withPrefix(\"/js/vs.loader.js\")\n    getLoaderScript.async = true\n    getLoaderScript.onload = () => {\n      // @ts-ignore\n      const re: any = global.require\n\n      re.config({\n        paths: {\n          vs: \"https://typescript.azureedge.net/cdn/4.0.5/monaco/min/vs\",\n          sandbox: withPrefix(\"/js/sandbox\"),\n        },\n        ignoreDuplicateModules: [\"vs/editor/editor.main\"],\n      })\n\n      re(\n        [\n          \"vs/editor/editor.main\",\n          \"vs/language/typescript/tsWorker\",\n          \"sandbox/index\",\n        ],\n        async (\n          main: typeof import(\"monaco-editor\"),\n          ts: typeof import(\"typescript\"),\n          sandboxEnv: typeof import(\"@typescript/sandbox\")\n        ) => {\n          // This triggers making \"ts\" available in the global scope\n          re([\"vs/language/typescript/lib/typescriptServices\"], async _ts => {\n            const ts = (global as any).ts\n            const isOK = main && ts && sandboxEnv\n\n            if (isOK) {\n              document\n                .getElementById(\"loader\")!\n                .parentNode?.removeChild(document.getElementById(\"loader\")!)\n            } else {\n              console.error(\n                \"Error: main\",\n                !!main,\n                \"ts\",\n                !!ts,\n                \"sandbox\",\n                !!sandboxEnv\n              )\n            }\n\n            document.getElementById(\"monaco-editor-embed\")!.style.display =\n              \"block\"\n            const sandbox = await sandboxEnv.createTypeScriptSandbox(\n              {\n                text: codeSamples[0].code,\n                compilerOptions: {},\n                domID: \"monaco-editor-embed\",\n                supportTwoslashCompilerOptions: true,\n              },\n              main,\n              ts\n            )\n            sandbox.editor.focus()\n\n            // @ts-ignore\n            window.sandbox = sandbox\n\n            const mapWithLibFiles = await createDefaultMapFromCDN(\n              { target: 3 },\n              \"3.7.3\",\n              true,\n              ts,\n              sandbox.lzstring as any\n            )\n\n            const runTwoslash = () => {\n              const newContent = sandbox.getText()\n              mapWithLibFiles.set(\"index.ts\", newContent)\n\n              try {\n                const newResults = twoslasher(newContent, \"tsx\", {\n                  tsModule: ts,\n                  lzstringModule: sandbox.lzstring as any,\n                  fsMap: mapWithLibFiles,\n                })\n                const codeAsFakeShikiTokens = newResults.code\n                  .split(\"\\n\")\n                  .map(line => [{ content: line }])\n                const html = twoslashRenderer(\n                  codeAsFakeShikiTokens,\n                  {},\n                  newResults,\n                  {}\n                )\n\n                const results = document.getElementById(\"twoslash-results\")!\n\n                document.getElementById(\"twoslash-failure\")!.style.display =\n                  \"none\"\n                document.getElementById(\"twoslash-results\")!.innerHTML = html\n\n                // Remove all the kids\n                while (results.firstChild) {\n                  results.removeChild(results.firstChild)\n                }\n\n                const p = document.createElement(\"p\")\n                p.innerText = newResults.extension\n                p.className = \"extension\"\n\n                const code = document.createElement(\"div\")\n                code.innerHTML = html\n\n                const a = document.createElement(\"a\")\n                a.innerText = \"Playground\"\n                a.href = newResults.playgroundURL\n\n                results.appendChild(p)\n                results.appendChild(code)\n                results.appendChild(a)\n              } catch (error) {\n                const err = error as Error\n                const failure = document.getElementById(\"twoslash-failure\")\n\n                if (!failure) return\n                failure.style.display = \"block\"\n\n                while (failure.firstChild) {\n                  failure.removeChild(failure.firstChild)\n                }\n\n                const content = document.createElement(\"div\")\n                content.className = \"err-content\"\n\n                const header = document.createElement(\"h3\")\n                header.textContent = \"Exception Raised\"\n\n                const text = document.createElement(\"p\")\n                const opener = err.name.startsWith(\"Error\")\n                  ? err.name.split(\"Error\")[1]\n                  : err.name\n                text.textContent = opener + err.message.split(\"## Code\")[0]\n\n                content.appendChild(header)\n                content.appendChild(text)\n                failure.appendChild(content)\n\n                console.log(error)\n              }\n            }\n\n            const debouncedTwoslash = debounce(runTwoslash, 500)\n            sandbox.editor.onDidChangeModelContent(debouncedTwoslash)\n            runTwoslash()\n\n            setTimeout(() => {\n              document\n                .querySelectorAll(\"#example-buttons .disabled\")\n                .forEach(button => {\n                  button.classList.remove(\"disabled\")\n                })\n\n              document.querySelectorAll(\".html-code\").forEach(codeElement => {\n                sandbox.monaco.editor\n                  .colorize(codeElement.textContent || \"\", \"html\", {\n                    tabSize: 2,\n                  })\n                  .then(newHTML => {\n                    codeElement.innerHTML = newHTML\n                  })\n              })\n\n              document.querySelectorAll(\".ts-code\").forEach(codeElement => {\n                sandbox.monaco.editor\n                  .colorize(codeElement.textContent || \"\", \"typescript\", {\n                    tabSize: 2,\n                  })\n                  .then(newHTML => {\n                    codeElement.innerHTML = newHTML\n                  })\n              })\n            }, 300)\n          })\n        }\n      )\n    }\n\n    document.body.appendChild(getLoaderScript)\n  }, [])\n\n  return (\n    <>\n      <Layout\n        title=\"Developers - Twoslash Code Samples\"\n        description=\"Learn about the TypeScript code sample library twoslash. Used for transpiling, providing hover to identifiers and compiler-driven error states.\"\n        lang=\"en\"\n      >\n        <div id=\"dev\">\n          <DevNav active=\"twoslash\" />\n          <div className=\"raised content main-content-block\">\n            <div className=\"split-fifty\">\n              <div>\n                <h1 style={{ marginTop: \"20px\" }}>TypeScript Twoslash</h1>\n                <p>\n                  A markup format for TypeScript code, ideal for creating\n                  self-contained code samples which let the TypeScript compiler\n                  do the extra leg-work.\n                </p>\n                <p>If you know TypeScript, you basically know twoslash.</p>\n                <p>\n                  Twoslash adds the ability to declare tsconfig options inline,\n                  split a sample into multiple files and a few other useful\n                  commands. You can see the full API{\" \"}\n                  <a href=\"https://github.com/microsoft/TypeScript-Website/tree/v2/packages/ts-twoslasher\">\n                    inside the README\n                  </a>\n                </p>\n              </div>\n              <div style={{ paddingTop: \"4.5rem\" }}>\n                <p>The Twoslash markup language helps with:</p>\n                <ul>\n                  <li>\n                    Enforcing accurate errors from a TypeScript code sample, and\n                    leaving the messaging to the compiler\n                  </li>\n                  <li>Splitting a code sample to hide distracting code</li>\n                  <li>\n                    Declaratively highlighting symbols in your code sample\n                  </li>\n                  <li>\n                    Replacing code with the results of transpilation to\n                    different files, or ancillary files like .d.ts or .map files\n                  </li>\n                  <li>Handle multi-file imports in a single code sample</li>\n                  <li>Creating a playground link for the code</li>\n                </ul>\n              </div>\n            </div>\n          </div>\n\n          <div\n            className=\"raised content main-content-block\"\n            style={{ maxWidth: \"90%\" }}\n          >\n            <div className=\"fivehundred\" style={{ flex: 1 }}>\n              <SuppressWhenTouch>\n                <h3 style={{ marginTop: \"0\" }}>Markup</h3>\n                <p id=\"exampleBlurb\">{codeSamples[0].blurb}</p>\n                <div id=\"loader\">\n                  <div className=\"lds-grid\">\n                    <div></div>\n                    <div></div>\n                    <div></div>\n                    <div></div>\n                    <div></div>\n                    <div></div>\n                    <div></div>\n                    <div></div>\n                    <div></div>\n                  </div>\n                  <p id=\"loading-message\" role=\"status\">\n                    Downloading Sandbox...\n                  </p>\n                </div>\n                <div\n                  style={{ height: \"300px\", display: \"none\" }}\n                  id=\"monaco-editor-embed\"\n                />\n                <div id=\"example-buttons\">\n                  {codeSamples.map(code => {\n                    const setExample = e => {\n                      if (e.target.classList.contains(\"disabled\")) return\n\n                      document.getElementById(\"exampleBlurb\")!.innerText =\n                        code.blurb\n                      // @ts-ignore\n                      window.sandbox.setText(code.code)\n                    }\n                    return (\n                      <div className=\"button disabled\" onClick={setExample}>\n                        {code.name}\n                      </div>\n                    )\n                  })}\n                </div>\n              </SuppressWhenTouch>\n            </div>\n\n            <div\n              style={{\n                paddingLeft: \"20px\",\n                borderLeft: \"1px solid gray\",\n                position: \"relative\",\n                flex: 1,\n                overflow: \"auto\",\n              }}\n            >\n              <SuppressWhenTouch>\n                <h3 style={{ marginTop: \"0\" }}>Results</h3>\n\n                <div id=\"twoslash-results\" />\n                <div id=\"twoslash-failure\" />\n              </SuppressWhenTouch>\n            </div>\n          </div>\n\n          <div className=\"raised main-content-block\">\n            <h2>Usage</h2>\n            <p>\n              Twoslash's usage guide is available on the npm README at{\" \"}\n              <a href=\"https://www.npmjs.com/package/@typescript/twoslash\">\n                <code>@typescript/twoslash</code>\n              </a>\n              .\n            </p>\n          </div>\n        </div>\n      </Layout>\n    </>\n  )\n}\n\nexport default (props: Props) => (\n  <Intl locale=\"en\">\n    <Index {...props} />\n  </Intl>\n)\n\n// prettier-ignore\nconst codeSamples = [\n  {\n    name: \"Highlights runtime types\",\n    blurb: \"See how TS Twoslash will grab the highlight information for identifiers in your code\",\n    code: `// @errors: 2532\ndeclare const quantumString: string | undefined;\n\n// Right now this string is in two states, hover below to see\nquantumString\n  \nif (quantumString) {\n  // However, in here we now have a different type\n  // you can verify by hovering below\n  quantumString.length;\n}\n    `\n  },\n  {\n    name: \"Show Errors\",\n    blurb: \"Twoslash will help highlight compiler error messages\",\n    code: `// @errors: 7006\nfunction fn(s) {\n  console.log(s.subtr(3))\n}\n\nfn(42)`\n  }, {\n    name: \"Set Compiler Flags\",\n    blurb: \"You can define compiler flags inline in a code sample which are removed from the output\",\n    code: `// @noImplicitAny: false\n// This will not throw because of the noImplicitAny\nfunction fn(s) {\n  console.log(s.subtr(3))\n}\n\nfn(42);`\n  }, {\n    name: \"Trims code\",\n    blurb: \"You can write code to help it compile in the sample which is hidden in the output\",\n    code: `interface IdLabel {id: number, /* some fields */ }\ninterface NameLabel {name: string, /* other fields */ }\ntype NameOrId<T extends number | string> = T extends number ? IdLabel : NameLabel;\n// This comment should not be included\n\n// ---cut---\nfunction createLabel<T extends number | string>(idOrName: T): NameOrId<T> {\n  throw \"unimplemented\"\n}\n\nlet a = createLabel(\"typescript\");`\n  },\n  {\n    name: \"Show the JS\",\n    blurb: \"Use @showEmit to show the JS files\",\n    code: `// @showEmit\nexport function getStringLength(value: string) {\n  return value\n}\n`},\n  {\n    name: \"Show the DTS\",\n    blurb: \"Use @showEmittedFile to set the d.ts file to be the result code\",\n    code: `// @declaration: true\n// @showEmit\n// @showEmittedFile: index.d.ts\n/**\n * Gets the length of a string\n * @param value a string\n */\nexport function getStringLength(value: string) {\n  return value\n}\n`},\n  {\n    name: \"Highlights\",\n    blurb: \"Highlight some code in the editor\",\n    code: `function greet(person: string, date: Date) {\n  console.log(\\`Hello \\${person}, today is \\${date.toDateString()}!\\`);\n}\n\ngreet(\"Maddison\", new Date());\n//                ^^^^^^^^^^\n`\n  }\n]\n"],"sourceRoot":""}